<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸŽŸ Event Booking & Ticket Management</title>

<style>
/* RESET */
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:Arial, Helvetica, sans-serif;
}

/* BODY */
body{
  background: linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.6)),
  url("https://images.unsplash.com/photo-1515165562835-c4c7b0b1b6c4");
  background-size:cover;
  background-attachment:fixed;
  color:white;
  min-height:100vh;
}

/* NAVBAR */
.navbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:15px 40px;
  background:rgba(0,0,0,0.85);
}

.navbar h2{
  font-size:22px;
}

.navbar ul{
  list-style:none;
  display:flex;
  gap:25px;
}

.navbar a{
  text-decoration:none;
  color:white;
  font-weight:bold;
}

.navbar a:hover{
  color:#00ffd5;
}

/* PAGE TITLE */
.title{
  text-align:center;
  margin:30px 0;
  font-size:28px;
}

/* HISTORY CONTAINER */
.history-container{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:25px;
  padding-bottom:40px;
}

/* BOOKING CARD */
.card{
  background:rgba(255,255,255,0.95);
  color:#000;
  width:300px;
  padding:20px;
  border-radius:15px;
  box-shadow:0 10px 25px rgba(0,0,0,0.4);
  text-align:center;
  transition:0.3s;
}

.card:hover{
  transform:scale(1.05);
}

/* QR IMAGE */
.card img{
  margin:15px 0;
  width:160px;
}

/* DATE TEXT */
.card p{
  font-size:14px;
  color:#444;
}

/* NO BOOKINGS */
.empty{
  text-align:center;
  font-size:20px;
  opacity:0.9;
}
</style>
</head>

<body>

<!-- NAVBAR -->
<div class="navbar">
  <h2>ðŸŽŸ Event Booking & Ticket Management</h2>
  <ul>
    <li><a href="events.html">Events</a></li>
    <li><a href="history.html">My Bookings</a></li>
    <li><a href="login.html" onclick="logout()">Logout</a></li>
  </ul>
</div>

<!-- TITLE -->
<div class="title">My Booking History</div>

<!-- BOOKINGS -->
<div class="history-container" id="history"></div>

<script>
function logout(){
  localStorage.clear();
}

const email = localStorage.getItem("email");

if(!email){
  alert("Please login first");
  window.location="login.html";
}

fetch("http://127.0.0.1:5002/history/" + email)
.then(res => res.json())
.then(data => {
  let html = "";

  if(data.length === 0){
    html = "<div class='empty'>No bookings yet</div>";
  }

  data.forEach(b => {
    html += `
      <div class="card">
        <h3>${b.eventTitle}</h3>
        <img src="${b.qr}">
        <p>Booked on:<br>${new Date(b.date).toLocaleString()}</p>
      </div>
    `;
  });

  document.getElementById("history").innerHTML = html;
});
</script>

</body>
</html>
